# Campaign Canvas - Project Context for Claude

## Project Overview

**Campaign Canvas** is an AI-powered social media campaign generator for small businesses. It creates ultra-specific, niche and location-aware campaigns by deeply understanding brand voice, target personas, and business context.

**Tech Stack**:
- **Frontend**: Vite + React + TypeScript + Shadcn/UI
- **Backend**: Supabase (PostgreSQL + Edge Functions)
- **AI**: Lovable AI Gateway (Google Gemini 2.5 Flash)
- **Deployment**: Lovable Cloud

---

## Core Philosophy: KISS + Specificity

### Design Principles

1. **Ultra-Specific Campaigns**: Location + Persona + Problem = Precise Messaging
   - âŒ "Social media for ice cream shops"
   - âœ… "Instagram campaign for Date Night Dani in Springfield, IL"

2. **Multi-Persona Strategy**:
   - Businesses have 3-5 personas (ice cream shop: Date Night Dani, Event Planner Emma, Treat Time Tom)
   - Each campaign targets ONE primary persona
   - Optional secondary persona for broader reach

3. **Minimal Friction**:
   - MVP focuses on essential fields only
   - Smart defaults and example-driven UX
   - Progressive disclosure for advanced features

---

## Project Structure

```
campaign-canvas-39/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                          # Shadcn UI components
â”‚   â”‚   â”œâ”€â”€ PersonaModalSimplified.tsx   # 228 lines (was 540)
â”‚   â”‚   â”œâ”€â”€ FileUploadModal.tsx          # AI-powered file upload
â”‚   â”‚   â””â”€â”€ ReviewSuggestionsModal.tsx   # Review AI suggestions
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Landing.tsx                  # User selection (3 demo users)
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx                # Main dashboard
â”‚   â”‚   â”œâ”€â”€ BrandHubSimplified.tsx       # 467 lines (was 838) âœ… ACTIVE
â”‚   â”‚   â”œâ”€â”€ Onboarding.tsx               # New user flow
â”‚   â”‚   â”œâ”€â”€ Campaign.tsx                 # Full campaign view
â”‚   â”‚   â”œâ”€â”€ CampaignWorking.tsx          # Active campaign generator
â”‚   â”‚   â”œâ”€â”€ CampaignResults.tsx          # Generated campaign display
â”‚   â”‚   â””â”€â”€ Settings.tsx                 # User settings
â”‚   â”‚
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ profiles.ts                  # BusinessProfile & Persona interfaces
â”‚   â”‚   â””â”€â”€ mockCampaigns.ts             # Mock campaign data
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ storage.ts                   # Supabase + localStorage helpers
â”‚   â”‚
â”‚   â”œâ”€â”€ integrations/
â”‚   â”‚   â””â”€â”€ supabase/                    # Auto-generated by Lovable
â”‚   â”‚       â”œâ”€â”€ client.ts                # Supabase client
â”‚   â”‚       â””â”€â”€ types.ts                 # Database types
â”‚   â”‚
â”‚   â””â”€â”€ App.tsx                          # Main routes
â”‚
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ migrations/                      # Database migrations
â”‚   â””â”€â”€ functions/
â”‚       â””â”€â”€ process-brand-upload/        # Edge function for AI file processing
â”‚           â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ SETUP_GUIDE.md                       # Setup instructions
â”œâ”€â”€ BRAND_HUB_IMPLEMENTATION.md          # Feature docs
â””â”€â”€ PROJECT_OVERVIEW.md                  # High-level overview
```

---

## Data Schema (Simplified MVP)

### Persona (6 fields - down from 15)

```typescript
interface Persona {
  id: string;
  name: string;              // "Date Night Dani", "Fix-It Felix"
  emoji: string;             // ðŸ’‘, ðŸ”§
  who_are_they: string;      // "Young couples (25-35) seeking Instagram-worthy dates"
  main_problem: string;      // "Want unique spots worth posting about"
  platforms: string[];       // ["instagram", "tiktok"] (max 3)
  real_example?: string;     // Optional customer story
}
```

**Removed**: demographics object, psychographics arrays, social_behavior details
**Why**: AI infers age/income from description; ONE problem > 5 pain points

### BusinessProfile (8 fields - down from 30+)

```typescript
interface BusinessProfile {
  id: string;
  business_name: string;           // "Stack Creamery"
  niche: string;                   // "ice_cream_shop"
  locations: string[];             // ["Springfield, IL"]
  what_we_offer: string;           // Multi-sentence description
  voice: {
    tone: string;                  // Single-select: "fun_playful"
    signature_phrases: string[];   // ["stack it up", "drip"] (max 5)
  };
  personas: Persona[];             // Multiple personas (3-5 typical)
}
```

**Removed**: programs, brand_identity, content_rules, audience, owner_name
**Why**: Not used in AI content generation; added complexity without value

---

## Key Features

### 1. Brand Hub (Simplified)

**Location**: `src/pages/BrandHubSimplified.tsx`

**3 Sections**:
1. **Business Basics** - Name, locations, what you offer
2. **Voice & Tone** - Single-select tone + 5 signature phrases
3. **Target Personas** - Multi-persona support, simplified modal

**Auto-save**: Every 30 seconds if changes detected

**UX Improvements**:
- Example-driven prompts ("e.g., Young couples seeking...")
- Helper text on every field
- Smart defaults
- Max limits (3 platforms, 5 phrases)

### 2. Persona Builder

**Location**: `src/components/PersonaModalSimplified.tsx`

**Form Fields** (2-3 min to complete):
1. Emoji picker (12 options)
2. Persona name (with helper: "alliterative name")
3. Who are they? (1-2 sentences)
4. Main problem/goal (single textarea)
5. Platforms (checkboxes, max 3)
6. Real example (optional)

**Examples in Preloaded Profiles**:
- **Stack Creamery**: Date Night Dani ðŸ’‘, Event Planner Emma ðŸŽ‰, Treat Time Tom ðŸ‘¨â€ðŸ‘§
- **Quick Fix Plumbing**: Fix-It Felix ðŸ”§, Clueless Carla ðŸ¤·â€â™€ï¸, Property Manager Pete ðŸ¢

### 3. Campaign Generation

**Flow**:
1. User sets campaign goal ("Get more weekend bookings")
2. Selects primary persona (Date Night Dani)
3. Optional: secondary persona (Treat Time Tom)
4. AI generates campaign using:
   - Business context (location, offerings, tone)
   - Persona details (problem, platforms)
   - Campaign goal

**AI Prompt Structure**:
```
Business: Stack Creamery (Springfield, IL)
Offering: Over-the-top ice cream with Instagram-worthy presentations
Voice: Fun & playful ("stack it up", "drip", "loaded")
Target: Date Night Dani - Young couples wanting photogenic date spots
Goal: Get more weekend bookings
Platforms: Instagram, TikTok

â†’ Generate: 7-day campaign with post scripts, hashtags, timing
```

---

## Lovable AI Integration

### How It Works

Edge functions run locally (Supabase CLI) or in production (Supabase Edge Runtime), calling Lovable AI Gateway over HTTPS.

**Edge Function**: `supabase/functions/process-brand-upload/index.ts`

```typescript
const lovableApiKey = Deno.env.get("LOVABLE_API_KEY");

const response = await fetch("https://ai.gateway.lovable.dev/v1/chat/completions", {
  method: "POST",
  headers: {
    "Authorization": `Bearer ${lovableApiKey}`,
    "Content-Type": "application/json",
  },
  body: JSON.stringify({
    model: "google/gemini-2.5-flash",
    messages: [/* your messages */]
  })
});
```

**Local Development**:
- Edge functions run via `supabase start`
- Calls Lovable AI Gateway (requires internet)
- Same behavior as production

**Free Tier**: Until Oct 13, 2025, all Gemini calls are FREE

---

## Database (Supabase)

### Tables

**brand_profiles**:
- Stores BusinessProfile objects
- RLS policies for user isolation
- JSONB columns for flexible schema

**Migrations**: `supabase/migrations/`

### Storage Functions

**Location**: `src/utils/storage.ts`

```typescript
saveProfile(profile: BusinessProfile)    // Upsert to Supabase
getProfile(id: string)                   // Fetch by ID
getCurrentProfile()                      // Get active profile
getAllProfiles()                         // Fetch all user profiles
```

---

## Recent Major Changes

### Code Simplification (Oct 2025)

**Removed**:
- 9 unused/duplicate files (2,689 lines)
- Duplicate Supabase client
- Old BrandHub.tsx (525 lines)
- 3 unused Campaign pages
- Test pages from routes
- Redundant documentation

**Result**: -2,689 lines, cleaner architecture

### Brand Hub Simplification (Oct 2025)

**Expert Analysis Applied**:
- Fortune 500 CMO: "60% of fields are noise for AI"
- Social Media Expert: "ONE persona per campaign = viral content"
- Behavioral Psychologist: "30 fields = 15% completion, 9 fields = 70%+"

**Changes**:
- Persona: 15 fields â†’ 6 fields (60% reduction)
- BusinessProfile: 30+ fields â†’ 8 fields (73% reduction)
- PersonaModal: 540 lines â†’ 228 lines (58% reduction)
- BrandHub: 838 lines â†’ 467 lines (44% reduction)

**Total**: -683 lines, better UX, same AI quality

---

## Development Workflow

### Local Setup

```bash
# Install dependencies
npm install

# Start dev server (includes Supabase)
npm run dev

# Visit http://localhost:8080
```

### Git Workflow

```bash
# Push changes
git add .
git commit -m "Your message"
git push origin main

# Auto-deploys to Lovable Cloud
```

### Environment Variables

Already configured in Lovable Cloud:
- `VITE_SUPABASE_URL`
- `VITE_SUPABASE_PUBLISHABLE_KEY`
- `LOVABLE_API_KEY` (for edge functions)

---

## Preloaded Demo Profiles

### Stack Creamery ðŸ¦
- **Niche**: Ice cream shop
- **Location**: Springfield, IL
- **Voice**: Fun & playful
- **Personas**:
  - Date Night Dani ðŸ’‘ (Instagram/TikTok)
  - Event Planner Emma ðŸŽ‰ (LinkedIn/Facebook)
  - Treat Time Tom ðŸ‘¨â€ðŸ‘§ (Facebook/Google)

### Quick Fix Plumbing ðŸ”§
- **Niche**: Plumbing service
- **Location**: Denver, CO
- **Voice**: Professional & polished
- **Personas**:
  - Fix-It Felix ðŸ”§ (Google/YouTube)
  - Clueless Carla ðŸ¤·â€â™€ï¸ (Facebook/Nextdoor)
  - Property Manager Pete ðŸ¢ (LinkedIn/Email)

### Test User ðŸ§ª
- Empty profile
- Resets on every load
- For development/testing

---

## Common Tasks

### Adding a New Persona Type

1. Update emoji options in `PersonaModalSimplified.tsx`
2. Add example in preloaded profiles (`data/profiles.ts`)
3. Update persona examples in Brand Hub

### Modifying Campaign Generation

1. Update AI prompt in campaign page
2. Ensure all persona fields are used appropriately
3. Test with multiple personas (primary + secondary)

### Adding a New Business Field

âš ï¸ **Think carefully** - does AI actually need this for content?
1. Add to `BusinessProfile` interface
2. Update `BrandHubSimplified.tsx` UI
3. Update `storage.ts` save/load functions
4. Update Supabase schema if needed

---

## Design Decisions & Rationale

### Why Single-Select Tone (not multi-select)?

**Before**: Users could pick 2-3 tones ("fun & playful" + "warm & friendly")
**Problem**: AI gets confused mixing tones, users over-select
**Fix**: Force ONE primary tone, adds clarity

### Why ONE Main Problem (not 5 pain points)?

**Before**: Users listed 5 pain points per persona
**Problem**: Users struggled to think of 5, AI couldn't focus
**Fix**: ONE problem = ONE campaign angle, ultra-specific

### Why Remove Demographics Fields?

**Before**: Age range, income level, family status, location types
**Problem**: Users guessed, AI infers better from description
**Fix**: "Young couples (25-35)" in description > separate age field

### Why Remove Brand Colors/Identity?

**Before**: Color picker, personality checkboxes, visual style
**Problem**: Used for visual design, not copy/content creation
**Fix**: Focus on voice/tone which affects written content

### Why Support Multiple Personas?

**Business Reality**: Ice cream shop serves couples, families, event planners
**Campaign Reality**: Each campaign targets ONE specific persona
**Solution**: Store 3-5 personas, pick one per campaign

---

## Performance Considerations

### Form Completion Rate

**Old Brand Hub**: 60+ min, 30+ fields â†’ ~15% completion (estimated)
**New Brand Hub**: 10 min, 8 fields â†’ ~70%+ completion (target)

### Code Maintenance

**Before Simplification**:
- 838-line BrandHub
- 540-line PersonaModal
- 2,689 lines of unused code

**After Simplification**:
- 467-line BrandHub (44% reduction)
- 228-line PersonaModal (58% reduction)
- Removed 3,372 total lines across cleanup + simplification

### AI Token Usage

**Optimized**: Fewer fields = smaller prompts = faster response, lower cost

---

## Known Issues & TODOs

### Current Limitations

- [ ] File upload shows modal but doesn't process yet
- [ ] Campaign generation uses mock data (needs AI integration)
- [ ] No user authentication (single user mode)
- [ ] Dashboard stats are placeholder

### Future Enhancements

- [ ] AI-assist buttons ("Generate persona from description")
- [ ] Campaign calendar view
- [ ] Analytics dashboard
- [ ] Multi-user support with auth
- [ ] Export campaigns to scheduling tools
- [ ] Advanced fields as collapsible sections

---

## Troubleshooting

### TypeScript Errors After Schema Change

```bash
# Run type check
npx tsc --noEmit

# Common fix: restart dev server
# Ctrl+C, then npm run dev
```

### Supabase Connection Issues

```bash
# Check if Supabase is running (local)
supabase status

# Restart Supabase
supabase stop
supabase start
```

### Profile Not Saving

- Check browser console for Supabase errors
- Verify all required fields are filled
- Check RLS policies in Supabase dashboard

---

## Key Files to Know

### Most Edited Files

1. **`src/pages/BrandHubSimplified.tsx`** - Main brand editing interface
2. **`src/components/PersonaModalSimplified.tsx`** - Persona creator
3. **`src/data/profiles.ts`** - Interfaces and demo data
4. **`src/utils/storage.ts`** - Data persistence

### Configuration Files

- **`src/App.tsx`** - Routes and page imports
- **`vite.config.ts`** - Build configuration
- **`tailwind.config.ts`** - Theme customization

### Auto-Generated (Don't Edit)

- **`src/integrations/supabase/`** - Lovable manages this
- **`supabase/migrations/`** - Database schema versions

---

## Testing Strategy

### Manual Testing Checklist

**Brand Hub**:
- [ ] Create new persona (all 6 fields)
- [ ] Edit existing persona
- [ ] Delete persona
- [ ] Add/remove locations
- [ ] Add/remove signature phrases (max 5)
- [ ] Change tone selection
- [ ] Auto-save triggers after 30s
- [ ] Manual save button works

**Multi-Persona**:
- [ ] Create 3+ personas for one business
- [ ] Each persona has different platforms
- [ ] Each persona has unique problem
- [ ] Real examples are optional

**Data Persistence**:
- [ ] Refresh page, data persists
- [ ] Switch profiles, correct data loads
- [ ] Navigate away and back, changes saved

---

## Contact & Resources

**Project Repo**: [GitHub Link]
**Deployment**: Lovable Cloud
**Documentation**:
- [Lovable Docs](https://docs.lovable.dev)
- [Supabase Docs](https://supabase.com/docs)
- [Shadcn/UI](https://ui.shadcn.com)

---

## Quick Reference

### Start Development
```bash
npm run dev
```

### Run Type Check
```bash
npx tsc --noEmit
```

### Deploy
```bash
git push origin main  # Auto-deploys
```

### View Database
```bash
supabase db studio  # Opens local DB UI
```

---

*Last Updated: October 2025*
*Project Version: MVP - Simplified Brand Hub*
